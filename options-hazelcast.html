<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2017-06-22 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20170622" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Providence &#x2013; Providence Hazelcast Portable</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
                      <a href="https://github.com/morimekta/providence">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>Providence</h2>
</div>
</div>
        <div class="pull-right"></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2017-06-22<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 0.4.1</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a>  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
          <li class="nav-header">Introduction</li>
    <li><a href="index.html" title="Providence"><span class="none"></span>Providence</a>  </li>
    <li><a href="models.html" title="Providence Models"><span class="none"></span>Providence Models</a>  </li>
    <li><a href="services.html" title="Providence Services"><span class="none"></span>Providence Services</a>  </li>
    <li><a href="apache-thrift.html" title="Comparing with Thrift"><span class="none"></span>Comparing with Thrift</a>  </li>
    <li><a href="https://github.com/morimekta/providence/releases" class="externalLink" title="Downloads & Releases"><span class="none"></span>Downloads & Releases</a>  </li>
          <li class="nav-header">Modules</li>
    <li><a href="providence-core/index.html" title="Core"><span class="none"></span>Core</a>  </li>
    <li><a href="providence-core-client/index.html" title="Core : Client"><span class="none"></span>Core : Client</a>  </li>
    <li><a href="providence-core-server/index.html" title="Core : Server"><span class="none"></span>Core : Server</a>  </li>
    <li><a href="providence-reflect/index.html" title="Utils : Reflect"><span class="none"></span>Utils : Reflect</a>  </li>
    <li><a href="providence-thrift/index.html" title="Utils : Thrift Bridge"><span class="none"></span>Utils : Thrift Bridge</a>  </li>
    <li><a href="providence-testing/index.html" title="Utils : Testing"><span class="none"></span>Utils : Testing</a>  </li>
    <li><a href="providence-config/index.html" title="Utils : Config"><span class="none"></span>Utils : Config</a>  </li>
    <li><a href="providence-storage/index.html" title="Utils : Storage"><span class="none"></span>Utils : Storage</a>  </li>
    <li><a href="providence-jax-rs/index.html" title="Utils : Javax-Ws-Rs"><span class="none"></span>Utils : Javax-Ws-Rs</a>  </li>
    <li><a href="providence-generator/index.html" title="Tools : Generator"><span class="none"></span>Tools : Generator</a>  </li>
    <li><a href="providence-generator-java/index.html" title="Tools : Generator - Java"><span class="none"></span>Tools : Generator - Java</a>  </li>
    <li><a href="providence-generator-json/index.html" title="Tools : Generator - JSON"><span class="none"></span>Tools : Generator - JSON</a>  </li>
    <li><a href="providence-maven-plugin/index.html" title="Tools : Maven Plugin"><span class="none"></span>Tools : Maven Plugin</a>  </li>
    <li><a href="providence-gradle-plugin.html" title="Tools : Gradle Plugin"><span class="none"></span>Tools : Gradle Plugin</a>  </li>
          <li class="nav-header">CLI Tools</li>
    <li><a href="providence-tools-converter.html" title="CLI : Converter"><span class="none"></span>CLI : Converter</a>  </li>
    <li><a href="providence-tools-rpc.html" title="CLI : RPC Tool"><span class="none"></span>CLI : RPC Tool</a>  </li>
    <li><a href="providence-tools-config.html" title="CLI : Config Helper"><span class="none"></span>CLI : Config Helper</a>  </li>
    <li><a href="providence-tools-compiler.html" title="CLI : Compiler"><span class="none"></span>CLI : Compiler</a>  </li>
          <li class="nav-header">Generator Options</li>
    <li><a href="options.html" title="Options Overview"><span class="none"></span>Options Overview</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>Hazelcast Portable</a>
  </li>
    <li><a href="options-android.html" title="Android Parcelable"><span class="none"></span>Android Parcelable</a>  </li>
    <li><a href="options-jackson.html" title="Jackson Annotations"><span class="none"></span>Jackson Annotations</a>  </li>
          <li class="nav-header">Documentation</li>
    <li><a href="release.html" title="Release Process"><span class="none"></span>Release Process</a>  </li>
    <li><a href="integration-testing.html" title="Integration Testing"><span class="none"></span>Integration Testing</a>  </li>
    <li><a href="serializer-binary.html" title="Serializer : Binary"><span class="none"></span>Serializer : Binary</a>  </li>
    <li><a href="serializer-fast-binary.html" title="Serializer : Fast Binary"><span class="none"></span>Serializer : Fast Binary</a>  </li>
    <li><a href="serializer-json.html" title="Serializer : JSON"><span class="none"></span>Serializer : JSON</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>Providence Hazelcast Portable</h1>
<p>I the code generation there is an option available for generating <a class="externalLink" href="http://docs.hazelcast.org/docs/3.5/manual/html/portableserialization.html"> Hazelcast Portable</a> interfaces in the builder. It is added in the builder as it won&#x2019;t work with the immutable thought for setting and reading in methods of the class.</p>
<p>The choice fell to Hazelcast Portable of the available serializer implemented as it supports the same logic required for thrift. Where you need to be able to add and remove fields between versions and still make it work with rolling out new versions of the code. With the restriction that any objects written in the new format will loose the old fields for that specific data structure.</p>
<div class="section">
<h2><a name="Generate_sources"></a>Generate sources</h2>
<p>The tool is part of the <a href="providence-tools.html#Code_Generator">providence code generator</a>. And takes an argument <tt>hazelcast_portable=true</tt> that will generate the required code. This also require a few annotations and a constant for each thrift file that should be generated. Here is an example:</p>
<div class="section">
<h3><a name="Example_thrift_file"></a>Example thrift file</h3>

<div class="source">
<div class="source"><pre class="prettyprint">namespace java net.morimekta.test.hazelcast.v1

const i32 FACTORY_ID = 1;

enum Value {
   FIRST = 1,
   SECOND = 2,
   THIRD = 3,
   FOURTH = 5,
   FIFTH = 8,
   SIXTH = 13,
   SEVENTH = 21,
   EIGHTH = 34,
   NINTH = 55,
   TENTH = 89,
   ELEVENTH = 144,
   TWELWETH = 233,
   /** @Deprecated */
   THIRTEENTH = 377,
   FOURTEENTH = 610,
   FIFTEENTH = 987,
   SIXTEENTH = 1597,
   SEVENTEENTH = 2584,
   EIGHTEENTH = 4181,
   NINTEENTH = 6765,
   TWENTIETH = 10946
}

struct CompactFields {
    1: required string name
    2: required i32 id,
    3: string label;
} (compact = &quot;&quot;, hazelcast.class.id = &quot;1&quot;)

const list&lt;CompactFields&gt; kDefaultCompactFields = [
  {&quot;name&quot;: &quot;Tut-Ankh-Amon&quot;, &quot;id&quot;: 1333, &quot;label&quot;: &quot;dead&quot;},
  {&quot;name&quot;: &quot;Ramses II&quot;, &quot;id&quot;: 1279}
];

struct OptionalFields {
    1: optional bool booleanValue;
    2: optional byte byteValue;
    3: optional i16 shortValue;
    4: optional i32 integerValue;
    5: optional i64 longValue;
    6: optional double doubleValue;
    7: optional string stringValue;
    8: optional binary binaryValue;
    9: optional Value enumValue;
    10: optional CompactFields compactValue;
} (hazelcast.class.id = &quot;2&quot;)

struct OptionalListFields {
    1: optional list&lt;bool&gt; booleanValues;
    2: optional list&lt;byte&gt; byteValues;
    3: optional list&lt;i16&gt; shortValues;
    4: optional list&lt;i32&gt; integerValue;
    5: optional list&lt;i64&gt; longValue;
    6: optional list&lt;double&gt; doubleValue;
    7: optional list&lt;string&gt; stringValue;
    10: optional list&lt;CompactFields&gt; compactValue;
} (hazelcast.class.id = &quot;3&quot;)

struct RequiredFields {
    1: required bool booleanValue;
    2: required byte byteValue,
    3: required i16 shortValue
    4: required i32 integerValue;
    5: required i64 longValue,
    6: required double doubleValue
    7: required string stringValue;
    8: required binary binaryValue,
    9: required Value enumValue;
    10: required CompactFields compactValue;
}
</pre></div></div>

<ul>
  
<li>Each thrift file needs to have the <tt>FACTORY_ID</tt> declared. This id is an integer  and needs to be unique for the entire hazelcast cluster you are working on. Be  it the code generated from providence or manually created factories.</li>
  
<li>Each struct that should be part of hazelcast needs to have the annotation  <tt>hazelcast.class.id</tt> with a unique id in that file (for each builderSupplier).</li>
  
<li>Each sub struct used in a builderSupplier also needs to have a unique id assigned to  them, in this case the CompactFields.</li>
</ul>
<p>Validation is in place for this to be printed as errors if you provide the <tt>hazelcast_portable=true</tt> to the code generator without providing the required fields.</p>
<p>If you don&#x2019;t provide any annotation in a trhift file, no builderSupplier will be created for that file even though you provide the <tt>hazelcast_portable=true</tt> flag.</p></div></div>
<div class="section">
<h2><a name="Limitations"></a>Limitations</h2>

<ul>
  
<li>The following types is supported:</li>
  
<li>binary (list of byte)</li>
  
<li>boolean</li>
  
<li>byte</li>
  
<li>double</li>
  
<li>enum</li>
  
<li>i16</li>
  
<li>i32</li>
  
<li>i64</li>
  
<li>string</li>
  
<li>message (sub structs)</li>
  
<li>The following list types are supported:</li>
  
<li>binary (list of byte)</li>
  
<li>byte</li>
  
<li>boolean</li>
  
<li>double</li>
  
<li>enum</li>
  
<li>i16</li>
  
<li>i32</li>
  
<li>i64</li>
  
<li>string</li>
  
<li>message (sub structs)</li>
  
<li>The following set types are supported:</li>
  
<li>binary (list of byte)</li>
  
<li>byte</li>
  
<li>boolean</li>
  
<li>double</li>
  
<li>enum</li>
  
<li>i16</li>
  
<li>i32</li>
  
<li>i64</li>
  
<li>string</li>
  
<li>message (sub structs)</li>
  
<li>The following map types are supported for keys:</li>
  
<li>binary (list of byte)</li>
  
<li>byte</li>
  
<li>boolean (although limited to 2 values :) )</li>
  
<li>double</li>
  
<li>enum</li>
  
<li>i16</li>
  
<li>i32</li>
  
<li>i64</li>
  
<li>string</li>
  
<li>message (sub structs)</li>
  
<li>list and set of the above</li>
  
<li>The following map types are supported for values:</li>
  
<li>binary (list of byte)</li>
  
<li>byte</li>
  
<li>boolean</li>
  
<li>double</li>
  
<li>enum</li>
  
<li>i16</li>
  
<li>i32</li>
  
<li>i64</li>
  
<li>string</li>
  
<li>message (sub structs)</li>
  
<li>list and set of the above</li>
</ul>
<p>Currently known items not supported is map of maps, list of lists or sets of sets as of 2017-04.</p>
<p>All maps will be serialized into a binary array, so it will never be available for searching with Hazelcast Predicate.</p></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
<script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-3087264-4', 'auto');
                ga('send', 'pageview');
            </script>
        </div>
        </div>
    </footer>
    </body>
</html>
